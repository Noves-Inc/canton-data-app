services:
  canton-data-app-frontend:
    image: canton-translate-ui-dist
    container_name: canton-data-app-frontend
    ports:
      - "8091:8091"
    environment:
      PORT: "8091"
      CANTON_TRANSLATE_BASE_URL: "http://canton-data-app-backend:8090" # Backend endpoint
      VITE_AUTH0_DOMAIN: "" # Auth0 domain
      VITE_AUTH0_CLIENT_ID: "" # Auth0 SPA client id
      VITE_AUTH0_REDIRECT_URI: "https://canton-translate-ui-devnet.dev.noves.fi/callback"
      VITE_AUTH0_LOGOUT_URL: "https://canton-translate-ui-devnet.dev.noves.fi"
    volumes:
      - data:/app/data
      - exports:/app/exports
    networks:
      - splice-validator_splice_validator
    depends_on:
      - canton-data-app-backend
    restart: unless-stopped

  canton-data-app-backend:
    image: canton-translate-dist
    container_name: canton-data-app-backend
    ports:
      - "8090:8090"
    environment:
      INDEX_DB_PATH: "./index.db" # Database storage location (points to persistent volume)
      CANTON_NODE_ADDR: "splice-validator-participant-1:5001" # Canton Ledger API endpoint
      CANTON_NODE_CERT_FILE_PATH: "" # TLS certificate path (empty string = no TLS)
    volumes:
      - data:/app/data
      - exports:/app/exports
      # - ./grpc_certificate.crt:/code/grpc_certificate.crt -> set this if you're using TLS and need to mount the certificate
    networks:
      - splice-validator_splice_validator
    restart: unless-stopped
networks:
  splice-validator_splice_validator:
    external: true

volumes:
  data: # Persistent storage for backend database
  exports: # Persistent storage for exported files
